name: "Java backend CI"

#events 
on: 
  push:
    branches: ["main", "develop"]
    #paths
    path:
      - 'backend/**'
  pull_request:
    branches: ["main", "develop"]
    #paths
    path:
      - 'backend/**'
env:
  java_version: 17
  java_distribution: temurin
defaults:
  run:
    working-directory: ./backend

  jobs:
    build: #first job
      runs-on: ubuntu-latest
      steps:
        - name: Check out code
          uses: actions/checkout@v4.1.7# action

        - name: Use Java ${{ env.java_version}}
          uses: actions/setup-java@v4
          with: 
            java-version: ${{ env.java_version }}
            java-distribution: ${{ env.java_distribution}}
            cache: 'npm'
            cache-dependency-path: './frontend/package-lock.json'
        
        - name: Run npm clean install
          run: npm ci

        - run: ./gradlew -b ci.gradle package
